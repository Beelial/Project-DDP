{% extends 'index.html' %}
{% block content %}

<main class="min-h-screen bg-[#f6fbfb] flex justify-center items-center px-4">
  <div class="w-full max-w-xl bg-white rounded-2xl shadow-lg p-8">

    <h1 class="text-2xl font-black mb-6 text-center">
      Edit Profil
    </h1>

    {% for message in messages %}
    <div class="django-message px-4 py-3 rounded-lg text-sm font-medium border transition-opacity duration-500
                {% if message.tags == 'success' %}
                bg-green-100 text-green-700 border-green-300
                {% elif message.tags == 'error' %}
                bg-red-100 text-red-700 border-red-300
                {% else %}
                bg-gray-100 text-gray-700 border-gray-300
                {% endif %}">
                {{ message }}
    </div>
    {% endfor %}
    <div class="flex flex-col items-center mb-6">
        
    <div
        class="w-20 h-20 rounded-full bg-blue-600
            flex items-center justify-center
            text-white text-3xl font-bold mb-3 select-none">
        {{ request.user.first_name|default:request.user.username|slice:":1"|upper }}
    </div>

    <h2 class="text-xl font-bold">
        {{ request.user.get_full_name|default:request.user.username }}
    </h2>

    <p class="text-gray-500 text-sm">
        {{ request.user.email }}
    </p>

    </div>

    <form method="POST" class="space-y-4">
      {% csrf_token %}

      <input
        name="username"
        value="{{ request.user.username }}"
        required
        class="w-full border p-3 rounded-lg"
        placeholder="Username"
      >

      <input
        type="email"
        name="email"
        value="{{ request.user.email }}"
        required
        class="w-full border p-3 rounded-lg"
        placeholder="Email"
      >

      <!-- TOGGLE -->
      <label class="flex items-center gap-2 cursor-pointer">
        <input type="checkbox" id="togglePassword" name="change_password">
        <span class="font-semibold">Ganti Password</span>
      </label>

      <!-- PASSWORD (HIDDEN) -->
      <div id="passwordBox" class="hidden space-y-3">
        <input
          type="password"
          name="new_password"
          placeholder="Password Baru"
          class="w-full border p-3 rounded-lg"
        >
        <input
          type="password"
          name="confirm_password"
          placeholder="Konfirmasi Password"
          class="w-full border p-3 rounded-lg"
        >
      </div>

      <button
        class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-500 transition">
        Simpan Perubahan
      </button>
    </form>

  </div>
</main>

<script>
document.getElementById('togglePassword').addEventListener('change', function () {
  document.getElementById('passwordBox').classList.toggle('hidden', !this.checked);
});
</script>
{% if redirect_home %}
<script>
  setTimeout(() => {
    window.location.href = "{% url 'home' %}";
  }, 2000);
</script>
{% endif %}

{% endblock %}
